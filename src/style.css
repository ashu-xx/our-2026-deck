@import "tailwindcss";

/* Common component primitives (prefer these over repeating long Tailwind class lists in templates) */
@layer components {
  .surface-card {
    @apply bg-white rounded-2xl shadow-2xl;
  }

  .surface-glass-nav {
    @apply bg-linear-to-r from-xmas-green/95 to-green-900/95 backdrop-blur-md border-b-4 border-gold shadow-2xl;
  }

  .btn {
    @apply inline-flex items-center justify-center font-semibold transition-all;
  }

  .btn-pill {
    @apply inline-flex items-center justify-center font-semibold transition-all;
    @apply px-4 py-2 rounded-full shadow-lg;
  }

  .btn-primary {
    @apply inline-flex items-center justify-center font-semibold transition-all;
    @apply bg-linear-to-r from-red-500 to-red-600 text-white hover:from-red-600 hover:to-red-700;
  }

  .btn-success {
    @apply inline-flex items-center justify-center font-semibold transition-all;
    @apply bg-linear-to-r from-green-600 to-green-700 text-white hover:from-green-700 hover:to-green-800;
  }

  .btn-info {
    @apply inline-flex items-center justify-center font-semibold transition-all;
    @apply bg-blue-500 text-white hover:bg-blue-600;
  }

  .btn-danger {
    @apply inline-flex items-center justify-center font-semibold transition-all;
    @apply bg-red-500 text-white hover:bg-red-600;
  }

  .tab-pill {
    @apply px-8 py-3 rounded-full transition-all font-semibold text-xmas-green hover:text-green-900;
  }

  .tab-pill-active {
    @apply bg-linear-to-r from-yellow-400 to-yellow-500 text-xmas-green font-bold shadow-lg;
  }

  .input-field {
    @apply w-full border-2 border-gray-300 rounded-xl text-black outline-none transition-all placeholder-gray-400;
    @apply focus:ring-2 focus:ring-yellow-400 focus:border-yellow-400;
  }

  /* Large card modal */
  .card-modal-overlay {
    position: fixed;
    inset: 0;
    z-index: 1000;
  }

  .card-modal-backdrop {
    position: absolute;
    inset: 0;
    background: rgba(0, 0, 0, 0.75);
    backdrop-filter: blur(6px);
  }

  .card-modal-dialog {
    position: relative;
    max-width: 980px;
    margin: 4vh auto;
    padding: 0 16px;
  }

  .card-modal-close {
    position: absolute;
    top: 10px;
    right: 22px;
    width: 40px;
    height: 40px;
    border-radius: 999px;
    background: rgba(17, 24, 39, 0.92);
    border: 1px solid rgba(255, 255, 255, 0.25);
    color: #ffffff;
    font-weight: 800;
    z-index: 2;
  }

  .card-modal-card {
    background: white;
    border-radius: 24px;
    overflow: hidden;
    box-shadow: 0 30px 90px rgba(0, 0, 0, 0.45);
    border: 2px solid rgba(255, 255, 255, 0.3);
  }

  .card-modal-image {
    position: relative;
    height: min(58vh, 520px);
    background: #0b1220;
  }

  .card-modal-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .card-modal-suit {
    position: absolute;
    top: 14px;
    right: 14px;
    width: 44px;
    height: 44px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(255, 255, 255, 0.92);
    border-radius: 999px;
    box-shadow: 0 10px 22px rgba(0, 0, 0, 0.25);
  }

  .card-modal-body {
    padding: 16px 18px 18px;
  }

  .card-modal-label {
    font-size: 11px;
    letter-spacing: 0.25em;
    text-transform: uppercase;
    font-weight: 800;
    color: rgba(15, 23, 42, 0.65);
  }

  .card-modal-title {
    margin-top: 6px;
    font-size: 22px;
    font-weight: 800;
    color: #0f172a;
  }

  .card-modal-desc {
    margin-top: 8px;
    color: rgba(15, 23, 42, 0.85);
    line-height: 1.35;
    font-size: 14px;
    white-space: pre-wrap;
  }

  .card-modal-completed {
    margin-top: 12px;
    display: inline-block;
    padding: 8px 12px;
    border-radius: 999px;
    background: linear-gradient(90deg, #22c55e, #10b981);
    color: white;
    font-weight: 900;
    font-size: 12px;
  }
}

@theme {
  --font-festive: Pacifico, cursive;
  --font-script: Dancing Script, cursive;

  --color-xmas-red: #d63447;
  --color-xmas-green: #1e5128;
  --color-gold: #ffd700;
  --color-soft-pink: #ffe5e5;
  --color-lavender: #d4a5f9;
  --color-mint: #a7f3d0;
}

:root {
  --tx: 0px;
  --ty: 0px;
  --rot: 0deg;
  --flip: 0deg;
}

.perspective {
  perspective: 1000px;
}

.transform-style-3d {
  transform-style: preserve-3d;
}

.backface-hidden {
  backface-visibility: hidden;
}

.rotate-y-180 {
  transform: rotateY(180deg);
}

/* Floating animation for decorative elements */
@keyframes float {
  0%, 100% { transform: translateY(0px) rotate(0deg); }
  50% { transform: translateY(-20px) rotate(5deg); }
}

@keyframes float-reverse {
  0%, 100% { transform: translateY(0px) rotate(0deg); }
  50% { transform: translateY(-15px) rotate(-5deg); }
}

@keyframes sparkle {
  0%, 100% { opacity: 1; transform: scale(1); }
  50% { opacity: 0.5; transform: scale(1.2); }
}

@keyframes slideIn {
  from { opacity: 0; transform: translateY(30px); }
  to { opacity: 1; transform: translateY(0); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-float-reverse {
  animation: float-reverse 5s ease-in-out infinite;
}

.animate-sparkle {
  animation: sparkle 2s ease-in-out infinite;
}

.animate-slide-in {
  animation: slideIn 0.6s ease-out forwards;
}

.animate-fade-in {
  animation: fadeIn 0.3s ease-out forwards;
}

/* Card hover effects */
.card-container {
  transition: transform 0.3s ease, box-shadow 0.3s ease;
  touch-action: manipulation;

  /* Ensure any focus/active highlight respects rounded corners */
  border-radius: 1.5rem; /* matches rounded-3xl */
  overflow: hidden;
  outline: none;
}

/* Use a rounded inset ring for keyboard focus instead of the browser's rectangular outline */
.card-container:focus,
.card-container:focus-visible {
  box-shadow: 0 0 0 4px rgba(148, 163, 184, 0.55), 0 0 0 8px rgba(148, 163, 184, 0.18);
}

.card-container:hover {
  transform: translateY(-10px);
  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
  filter: brightness(1.05);
}

.card-container:hover:focus,
.card-container:hover:focus-visible {
  box-shadow:
    0 20px 40px rgba(0, 0, 0, 0.3),
    0 0 0 4px rgba(148, 163, 184, 0.55),
    0 0 0 8px rgba(148, 163, 184, 0.18);
}

/* Gradient backgrounds for suits */
.suit-hearts {
  background: linear-gradient(135deg, #ffeef8 0%, #ffd7e8 100%);
}

.suit-diamonds {
  background: linear-gradient(135deg, #fff9e6 0%, #ffe5b4 100%);
}

.suit-clubs {
  background: linear-gradient(135deg, #e6f7ef 0%, #b8f2d6 100%);
}

.suit-spades {
  background: linear-gradient(135deg, #f0e6ff 0%, #dfc7ff 100%);
}

.suit-joker {
  background: linear-gradient(135deg, #fff0f0 0%, #ffe0e0 100%);
}

/* Decorative background pattern */
.bg-pattern {
  background-image:
    radial-gradient(circle at 20% 50%, rgba(255, 215, 0, 0.1) 0%, transparent 50%),
    radial-gradient(circle at 80% 80%, rgba(212, 165, 249, 0.1) 0%, transparent 50%),
    radial-gradient(circle at 40% 20%, rgba(167, 243, 208, 0.1) 0%, transparent 50%);
}

/* Card flip animation enhancement */
.card-inner {
  /* Defaults for the CSS analyzer + runtime safety */
  --tx: 0px;
  --ty: 0px;
  --rot: 0deg;
  --flip: 0deg;

  transition: transform 0.7s cubic-bezier(0.4, 0.0, 0.2, 1), box-shadow 0.35s ease;
  transform: translate3d(var(--tx, 0px), var(--ty, 0px), 0) rotate(var(--rot, 0deg)) rotateY(var(--flip, 0deg));
  transform-style: preserve-3d;
}

.card-inner.flipped {
  --flip: 180deg;
}

.card-inner.dragging {
  transition: none;
  cursor: grabbing;
  box-shadow: 0 24px 60px rgba(0, 0, 0, 0.35);
}

/* Joker special styling */
.joker-shimmer {
  background: linear-gradient(
    45deg,
    #ffd700 0%,
    #ffed4e 25%,
    #ffd700 50%,
    #ffed4e 75%,
    #ffd700 100%
  );
  background-size: 200% 200%;
  animation: shimmer 3s ease infinite;
}

@keyframes shimmer {
  0% { background-position: 0 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0 50%; }
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 10px;
}

::-webkit-scrollbar-track {
  background: rgba(30, 81, 40, 0.3);
}

::-webkit-scrollbar-thumb {
  background: #ffd700;
  border-radius: 5px;
}

::-webkit-scrollbar-thumb:hover {
  background: #ffed4e;
}

/* Additional UI enhancements */
.bg-clip-text {
  -webkit-background-clip: text;
  background-clip: text;
}

/* Button press animation */
button:active {
  transform: scale(0.98);
}

/* Input focus glow */
input:focus,
textarea:focus,
select:focus {
  box-shadow: 0 0 0 3px rgba(255, 215, 0, 0.2);
}

/* Card grid responsive improvements */
@media (max-width: 640px) {
  .perspective.card-container {
    width: 90vw !important;
    max-width: 340px;
    height: 0 !important;
    padding-bottom: 140%; /* Aspect ratio for playing card (roughly 2:3) */
    position: relative;
    margin: 0 auto;
  }

  .card-inner {
    position: absolute !important;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
  }

  .card-inner > div {
    height: 100%;
  }

  /* Ensure card content fits on mobile */
  .card-inner .text-6xl {
    font-size: 2.5rem;
  }

  .card-inner .text-3xl {
    font-size: 1.5rem;
  }

  .card-inner .text-lg {
    font-size: 0.95rem;
  }

  .card-inner .text-sm {
    font-size: 0.8rem;
  }

  /* Adjust image heights on mobile for proper fit */
  .card-inner .h-56 {
    height: 11rem;
  }

  .card-inner .h-40 {
    height: 8rem;
  }

  /* Ensure buttons are visible and clickable */
  .card-inner button {
    min-height: 32px;
    min-width: 32px;
  }

  /* Limit description to 2 lines on mobile */
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
}

/* Smooth transitions for all interactive elements */
button,
input,
select,
textarea {
  transition: all 0.2s ease;
}

/* Navigation hover effects */
nav button:hover {
  transform: scale(1.05) translateY(-2px);
}

/* Profile avatar animation */
@keyframes pulse-ring {
  0% {
    box-shadow: 0 0 0 0 rgba(255, 215, 0, 0.7);
  }
  70% {
    box-shadow: 0 0 0 10px rgba(255, 215, 0, 0);
  }
  100% {
    box-shadow: 0 0 0 0 rgba(255, 215, 0, 0);
  }
}

.animate-pulse-ring {
  animation: pulse-ring 2s infinite;
}

/* Gradient text effect */
.gradient-text {
  background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
}

/* Loading spinner */
@keyframes spin {
  to {
    transform: rotate(360deg);
  }
}

.animate-spin {
  animation: spin 1s linear infinite;
}

/* Success checkmark animation */
@keyframes checkmark {
  0% {
    transform: scale(0) rotate(45deg);
  }
  100% {
    transform: scale(1) rotate(45deg);
  }
}

.animate-checkmark {
  animation: checkmark 0.4s ease-out;
}

/* Dealing overlay styling (outside @layer for simplicity) */
.dealing-overlay {
  @apply fixed inset-0 z-100 bg-black/50 backdrop-blur-md flex items-center justify-center p-6;
}

.dealing-card {
  @apply relative w-full max-w-[420px] p-6 border-2 border-white/20 rounded-[18px] bg-[#111827]/90 text-white overflow-hidden shadow-[0_25px_70px_rgba(0,0,0,0.45)];
}

.dealing-bg-circle {
  @apply absolute w-[11rem] h-[11rem] rounded-full blur-[32px] opacity-85;
}

.dealing-bg-1 {
  @apply top-[-4rem] right-[-4rem] bg-[linear-gradient(135deg,rgba(253,224,71,0.25),rgba(244,114,182,0.2),rgba(74,222,128,0.25))];
}

.dealing-bg-2 {
  @apply bottom-[-4rem] left-[-4rem] bg-[linear-gradient(135deg,rgba(244,114,182,0.25),rgba(74,222,128,0.2),rgba(253,224,71,0.25))];
}

.dealing-header { @apply relative z-1 text-center mb-2; }
.dealing-title { @apply font-extrabold text-xl mb-1; }
.dealing-subtitle { @apply text-white/70 text-sm; }

.dealing-stage { @apply relative h-[12.5rem] w-[13rem] mx-auto my-2; }

.deal-card {
  @apply absolute left-1/2 top-1/2 w-[92px] h-[134px] -translate-x-1/2 -translate-y-1/2 rounded-[18px] border-3 border-white/92 shadow-[0_26px_60px_rgba(0,0,0,0.45)] overflow-hidden;
  background:
    radial-gradient(120px 120px at 20% 20%, rgba(255, 255, 255, 0.18), transparent 60%),
    linear-gradient(135deg, rgba(185, 28, 28, 0.96), rgba(225, 29, 72, 0.9), rgba(21, 128, 61, 0.9));
  will-change: transform, opacity;
}

.deal-card::before {
  content: '';
  @apply absolute inset-[-40px] bg-[linear-gradient(120deg,transparent_30%,rgba(255,255,255,0.35)_50%,transparent_70%)] translate-x-[-60%] rotate-[10deg] opacity-55;
  animation: shimmer 1.2s ease-in-out infinite;
}

.deal-card::after {
  content: attr(data-suit);
  @apply absolute right-2 bottom-2 text-[22px] text-white/95;
  text-shadow: 0 2px 12px rgba(0, 0, 0, 0.35);
}

@keyframes shimmer {
  0% { transform: translateX(-60%) rotate(10deg); }
  100% { transform: translateX(60%) rotate(10deg); }
}

@keyframes dealMove1 {
  0% { transform: translate(-50%, -50%) rotate(0deg) scale(0.92); opacity: 0.0; filter: blur(0.5px); }
  12% { opacity: 1; }
  55% { transform: translate(calc(-50% - 78px), calc(-50% - 14px)) rotate(-12deg) scale(1.02); opacity: 1; filter: blur(0px); }
  100% { transform: translate(calc(-50% - 78px), calc(-50% - 14px)) rotate(-12deg) scale(0.98); opacity: 0.62; }
}

@keyframes dealMove2 {
  0% { transform: translate(-50%, -50%) rotate(0deg) scale(0.92); opacity: 0.0; filter: blur(0.5px); }
  12% { opacity: 1; }
  55% { transform: translate(calc(-50% - 22px), calc(-50% - 40px)) rotate(8deg) scale(1.02); opacity: 1; filter: blur(0px); }
  100% { transform: translate(calc(-50% - 22px), calc(-50% - 40px)) rotate(8deg) scale(0.98); opacity: 0.62; }
}

@keyframes dealMove3 {
  0% { transform: translate(-50%, -50%) rotate(0deg) scale(0.92); opacity: 0.0; filter: blur(0.5px); }
  12% { opacity: 1; }
  55% { transform: translate(calc(-50% + 34px), calc(-50% - 34px)) rotate(16deg) scale(1.02); opacity: 1; filter: blur(0px); }
  100% { transform: translate(calc(-50% + 34px), calc(-50% - 34px)) rotate(16deg) scale(0.98); opacity: 0.62; }
}

@keyframes dealMove4 {
  0% { transform: translate(-50%, -50%) rotate(0deg) scale(0.92); opacity: 0.0; filter: blur(0.5px); }
  12% { opacity: 1; }
  55% { transform: translate(calc(-50% + 88px), calc(-50% - 4px)) rotate(24deg) scale(1.02); opacity: 1; filter: blur(0px); }
  100% { transform: translate(calc(-50% + 88px), calc(-50% - 4px)) rotate(24deg) scale(0.98); opacity: 0.62; }
}

.deal-card-1 { animation: dealMove1 1.1s ease-in-out infinite; }
.deal-card-2 { animation: dealMove2 1.1s ease-in-out infinite; animation-delay: 0.09s; }
.deal-card-3 { animation: dealMove3 1.1s ease-in-out infinite; animation-delay: 0.18s; }
.deal-card-4 { animation: dealMove4 1.1s ease-in-out infinite; animation-delay: 0.27s; }

.spark {
  @apply absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 text-[18px] text-white/75;
  text-shadow: 0 8px 18px rgba(0, 0, 0, 0.35);
  opacity: 0;
  pointer-events: none;
  will-change: transform, opacity;
}

@keyframes sparkle {
  0% { transform: translate(-50%, -50%) scale(0.6); opacity: 0; }
  15% { opacity: 0.9; }
  100% { transform: translate(calc(-50% + var(--sx)), calc(-50% + var(--sy))) scale(1.15); opacity: 0; }
}

.spark-1 { --sx: -80px; --sy: -70px; animation: sparkle 900ms ease-out infinite; }
.spark-2 { --sx: 85px;  --sy: -66px; animation: sparkle 900ms ease-out infinite; animation-delay: 150ms; }
.spark-3 { --sx: -92px; --sy: 56px;  animation: sparkle 900ms ease-out infinite; animation-delay: 300ms; }
.spark-4 { --sx: 96px;  --sy: 62px;  animation: sparkle 900ms ease-out infinite; animation-delay: 450ms; }

.dealing-footer {
  @apply text-center text-white/85 text-[0.9rem];
}

@media (prefers-reduced-motion: reduce) {
  .deal-card::before, .deal-card-1, .deal-card-2, .deal-card-3, .deal-card-4, .spark { animation: none; opacity: 1; }
}

/* Pile-based card layout */
.pile-container {
  @apply relative;
}

.card-pile-stack {
  pointer-events: none;
}

@keyframes dealFromPile {
  0% {
    transform: translateY(0) scale(1);
    opacity: 1;
  }
  50% {
    transform: translateY(-30px) scale(1.05);
    opacity: 0.8;
  }
  100% {
    transform: translateY(0) scale(1);
    opacity: 1;
  }
}

[data-pile-cards] .card-container {
  animation: dealFromPile 0.6s ease-out;
}

/* Birthday celebration overlay */
.birthday-overlay {
  position: fixed;
  inset: 0;
  z-index: 1100;
  pointer-events: none;
}

.birthday-backdrop {
  position: absolute;
  inset: 0;
  background: radial-gradient(circle at 50% 40%, rgba(255, 255, 255, 0.18), rgba(0, 0, 0, 0.55));
  backdrop-filter: blur(3px);
}

.birthday-center {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -55%);
  text-align: center;
  color: white;
  text-shadow: 0 10px 35px rgba(0, 0, 0, 0.55);
}

.birthday-emoji {
  font-size: 88px;
  animation: birthdayPop 520ms ease-out;
}

.birthday-title {
  margin-top: 8px;
  font-size: 34px;
  font-weight: 900;
}

.birthday-sub {
  margin-top: 6px;
  font-size: 14px;
  opacity: 0.9;
}

.birthday-balloons {
  position: absolute;
  inset: 0;
  overflow: hidden;
}

.birthday-float {
  position: absolute;
  bottom: -40px;
  font-size: 26px;
  animation-name: birthdayFloat;
  animation-timing-function: ease-out;
  animation-fill-mode: forwards;
}

@keyframes birthdayFloat {
  0% { transform: translateY(0) rotate(0deg); opacity: 0; }
  12% { opacity: 1; }
  100% { transform: translateY(-110vh) rotate(18deg); opacity: 0; }
}

@keyframes birthdayPop {
  0% { transform: scale(0.6); opacity: 0; }
  100% { transform: scale(1); opacity: 1; }
}
